import{r as m,p as x,j as P,q as k,y as C,c as V,o as _,w as o,a as t,z as q,b as d,B as w}from"./vendor-CQEko2iO.js";import{_ as v,M}from"./Button-CzEj_lhU.js";import{_ as y,a as g}from"./Input-ZV2_aOD0.js";import{a as T,u as $}from"./index-BFIuO1Fv.js";import"./fullcalendar-PBRWkKLf.js";const B={class:"flex gap-2 justify-end"},F={__name:"ModalSetupPassword",emits:["close","password-configured"],setup(S,{emit:b}){const u=b,p=$(),a=m(!1),i=m(""),n=m(""),f=x("passwordInput"),r=P({password:"",confirmPassword:""});async function c(){if(!a.value){r.password="",r.confirmPassword="",a.value=!0;try{const s=await T.auth.setupPassword(i.value,n.value);s.success?(p.success(s.message||"Password configured successfully! You can now log in."),u("password-configured")):(p.error(s.message||"Failed to configure password"),s.errors&&Object.keys(s.errors).forEach(e=>{r.hasOwnProperty(e)&&(r[e]=s.errors[e])}))}catch(s){p.error("Failed to configure password: "+s.message)}finally{a.value=!1}}}return k(async()=>{await C(),f.value?.focus()}),(s,e)=>(_(),V(M,{title:"Setup Application Password",onClose:e[3]||(e[3]=l=>u("close"))},{footer:o(()=>[t("div",B,[d(v,{type:"submit",onClick:c,loading:a.value,disabled:!i.value||!n.value,variant:"primary"},{default:o(()=>[...e[5]||(e[5]=[w(" Configure Password ",-1)])]),_:1},8,["loading","disabled"]),d(v,{onClick:e[2]||(e[2]=l=>u("close")),disabled:a.value},{default:o(()=>[...e[6]||(e[6]=[w("Cancel",-1)])]),_:1},8,["disabled"])])]),default:o(()=>[e[7]||(e[7]=t("div",{class:"text-center mb-6"},[t("h3",{class:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2"}," Welcome to Calendar! "),t("p",{class:"text-sm text-gray-600 dark:text-gray-400"}," To secure your calendar application, please create an admin password. ")],-1)),t("form",{onSubmit:q(c,["prevent"])},[e[4]||(e[4]=t("input",{type:"text",name:"username",autocomplete:"username",value:"admin",readonly:"","aria-hidden":"true",tabindex:"-1",style:{position:"absolute",left:"-9999px",width:"1px",height:"1px"}},null,-1)),d(y,{label:"Admin Password",required:"","input-id":"password",error:r.password},{default:o(()=>[d(g,{id:"password",modelValue:i.value,"onUpdate:modelValue":e[0]||(e[0]=l=>i.value=l),type:"password",placeholder:"Enter admin password (min 8 characters)",required:"",ref_key:"passwordInput",ref:f,disabled:a.value,autocomplete:"new-password"},null,8,["modelValue","disabled"])]),_:1},8,["error"]),d(y,{label:"Confirm Password",required:"","input-id":"confirmPassword",error:r.confirmPassword},{default:o(()=>[d(g,{id:"confirmPassword",modelValue:n.value,"onUpdate:modelValue":e[1]||(e[1]=l=>n.value=l),type:"password",placeholder:"Confirm admin password",required:"",disabled:a.value,autocomplete:"new-password"},null,8,["modelValue","disabled"])]),_:1},8,["error"])],32)]),_:1}))}};export{F as default};
