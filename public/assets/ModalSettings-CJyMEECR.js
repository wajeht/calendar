import{l as Ae,r as h,C as oe,p as de,D as ne,E as ie,G as Te,o as y,e as C,H as ue,I as ze,J as I,a as t,K as Me,n as qe,g as V,B as p,t as A,c as P,w as o,z as ee,b as s,k as z,m as ce,F as fe,f as ge,L as pe,j as Oe,q as Be,u as T}from"./vendor-DfjTe3v5.js";import{a as S,u as N,b as Ie,c as Ne}from"./index-B2sipo_L.js";import{_ as w,M as D}from"./Button-CC4DDPTB.js";import{_ as $,a as F}from"./Input-BxoBBgjz.js";import"./fullcalendar-DAzJmkx6.js";function le(k,_={}){const{immediate:v=!0}=_,g=h(null),l=h(null),n=h(!1);let r=null;function c(){r&&(r.abort(),r=null)}async function m(){c(),r=new AbortController,n.value=!0,l.value=null;try{const i=await k({signal:r.signal});return g.value=i,i}catch(i){if(i&&i.name==="AbortError")return;throw l.value=i,i}finally{n.value=!1}}return Ae(()=>c()),v&&m(),{data:g,error:l,loading:n,refresh:m,abort:c}}const De=["disabled","required"],se={__name:"Select",props:oe({disabled:{type:Boolean,default:!1},required:{type:Boolean,default:!1}},{modelValue:{type:[String,Number],default:""},modelModifiers:{}}),emits:["update:modelValue"],setup(k,{expose:_}){const v=de("selectRef"),g=ne(k,"modelValue"),l=k;function n(){v.value?.focus()}function r(){v.value?.blur()}_({focus:n,blur:r});const c=I(()=>{const m=[];return l.disabled&&m.push("bg-gray-100 dark:bg-gray-800 cursor-not-allowed opacity-50"),m.join(" ")});return(m,i)=>ie((y(),C("select",ze({ref_key:"selectRef",ref:v,class:["w-full px-2 py-1.5 border border-gray-300 rounded-sm text-[13px] box-border focus:outline-none focus:border-blue-400 focus:shadow-[0_0_4px_rgba(102,175,233,0.6)]","dark:bg-gray-800 dark:border-gray-600 dark:text-gray-100 dark:focus:border-blue-500 dark:focus:shadow-[0_0_4px_rgba(59,130,246,0.5)]",c.value],"onUpdate:modelValue":i[0]||(i[0]=b=>g.value=b),disabled:l.disabled,required:l.required,style:{"font-family":"inherit"}},m.$attrs),[ue(m.$slots,"default")],16,De)),[[Te,g.value]])}},Ze=["for"],He={class:"relative flex items-center mr-2"},Je=["id","disabled"],Ge={key:0,class:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20"},We={class:"flex-1"},M=Object.assign({inheritAttrs:!1},{__name:"Checkbox",props:oe({label:{type:String,default:""},disabled:{type:Boolean,default:!1},id:{type:String,default:""}},{modelValue:{type:[Boolean,Number],default:!1},modelModifiers:{}}),emits:["update:modelValue"],setup(k){const _=ne(k,"modelValue"),v=k,g=`checkbox-${Math.random().toString(36).substr(2,9)}`,l=I(()=>v.id||g);return(n,r)=>(y(),C("label",{for:l.value,class:"cursor-pointer font-normal text-gray-800 dark:text-gray-200 text-[13px] leading-relaxed m-0 flex items-center"},[t("div",He,[ie(t("input",{id:l.value,type:"checkbox","onUpdate:modelValue":r[0]||(r[0]=c=>_.value=c),disabled:v.disabled,class:"sr-only"},null,8,Je),[[Me,_.value]]),t("div",{class:qe(["w-4 h-4 border rounded-sm flex items-center justify-center transition-all duration-200",_.value?"border-slate-700 bg-slate-700 dark:border-slate-500 dark:bg-slate-600":"border-gray-300 bg-white hover:border-slate-400 dark:border-gray-600 dark:bg-gray-800 dark:hover:border-slate-500",v.disabled?"opacity-50 cursor-not-allowed":"cursor-pointer"])},[_.value?(y(),C("svg",Ge,[...r[1]||(r[1]=[t("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"},null,-1)])])):V("",!0)],2)]),t("span",We,[ue(n.$slots,"default",{},()=>[p(A(v.label),1)])])],8,Ze))}}),Ye={class:"space-y-4"},Ke={class:"flex flex-col gap-3"},Qe={class:"flex gap-2 justify-end"},Xe={__name:"ModalAddCalendar",props:{highZIndex:{type:Boolean,default:!1}},emits:["close","calendar-added"],setup(k,{emit:_}){const v=k,g=_,l=N(),n=h(!1),r=z({name:"",url:"",color:"#3b82f6",visible_to_public:!0,show_details_to_public:!0}),c=z({name:"",url:"",color:""});function m(){r.name="",r.url="",r.color="#3b82f6",r.visible_to_public=!0,r.show_details_to_public=!0,c.name="",c.url="",c.color=""}async function i(){n.value=!0,c.name="",c.url="",c.color="";try{const d=await S.calendar.create(r);d.success?(l.success(d.message||"Calendar added successfully"),g("calendar-added"),g("close"),m()):(l.error(d.message||"Failed to add calendar"),d.errors&&Object.keys(d.errors).forEach(u=>{c.hasOwnProperty(u)&&(c[u]=d.errors[u])}))}catch(d){l.error("Error adding calendar: "+d.message)}finally{n.value=!1}}function b(){g("close"),m()}return(d,u)=>(y(),P(D,{title:"Add New Calendar","high-z-index":v.highZIndex,onClose:b},{footer:o(()=>[t("div",Qe,[s(w,{type:"submit",variant:"primary",onClick:i,loading:n.value},{default:o(()=>[...u[5]||(u[5]=[p(" Add Calendar ",-1)])]),_:1},8,["loading"]),s(w,{type:"button",onClick:b},{default:o(()=>[...u[6]||(u[6]=[p("Cancel",-1)])]),_:1})])]),default:o(()=>[t("form",{onSubmit:ee(i,["prevent"])},[t("div",Ye,[s($,{label:"Name",required:"","input-id":"calendar-name",error:c.name},{default:o(()=>[s(F,{id:"calendar-name",modelValue:r.name,"onUpdate:modelValue":u[0]||(u[0]=x=>r.name=x),type:"text",placeholder:"Calendar name",required:""},null,8,["modelValue"])]),_:1},8,["error"]),s($,{label:"URL",required:"","input-id":"calendar-url",error:c.url},{default:o(()=>[s(F,{id:"calendar-url",modelValue:r.url,"onUpdate:modelValue":u[1]||(u[1]=x=>r.url=x),type:"url",placeholder:"https://example.com/calendar.ics",required:""},null,8,["modelValue"])]),_:1},8,["error"]),s($,{label:"Color","input-id":"calendar-color",error:c.color},{default:o(()=>[s(F,{id:"calendar-color",modelValue:r.color,"onUpdate:modelValue":u[2]||(u[2]=x=>r.color=x),type:"color"},null,8,["modelValue"])]),_:1},8,["error"]),t("div",Ke,[s(M,{id:"add-hide-from-public","model-value":!r.visible_to_public,"onUpdate:modelValue":u[3]||(u[3]=x=>r.visible_to_public=!x),label:"Hide calendar from public view"},null,8,["model-value"]),s(M,{id:"add-hide-details-from-public","model-value":!r.show_details_to_public,"onUpdate:modelValue":u[4]||(u[4]=x=>r.show_details_to_public=!x),label:"Hide event details for public view (show as time blocks only)"},null,8,["model-value"])])])],32)]),_:1},8,["high-z-index"]))}},et={class:"space-y-4"},tt={class:"flex flex-col gap-3"},at={class:"flex gap-2 justify-end"},rt={__name:"ModalEditCalendar",props:{calendar:{type:Object,required:!0},highZIndex:{type:Boolean,default:!1}},emits:["close","calendar-updated"],setup(k,{emit:_}){const v=k,g=_,l=N(),n=h(!1),r=z({name:"",url:"",color:"#3b82f6",visible_to_public:!0,show_details_to_public:!0}),c=z({name:"",url:"",color:""});ce(()=>v.calendar,b=>{b&&(r.name=b.name||"",r.url=b.url||"",r.color=b.color||"#3b82f6",r.visible_to_public=!!b.visible_to_public,r.show_details_to_public=!!b.show_details_to_public,c.name="",c.url="",c.color="")},{immediate:!0});async function m(){n.value=!0,c.name="",c.url="",c.color="";try{const b=await S.calendar.update(v.calendar.id,r);b.success?(l.success(b.message||"Calendar updated successfully"),g("calendar-updated"),g("close")):(l.error(b.message||"Failed to update calendar"),b.errors&&Object.keys(b.errors).forEach(d=>{c.hasOwnProperty(d)&&(c[d]=b.errors[d])}))}catch(b){l.error("Error updating calendar: "+b.message)}finally{n.value=!1}}function i(){g("close")}return(b,d)=>(y(),P(D,{title:"Edit Calendar","high-z-index":v.highZIndex,onClose:i},{footer:o(()=>[t("div",at,[s(w,{type:"submit",variant:"primary",onClick:m,loading:n.value},{default:o(()=>[...d[5]||(d[5]=[p(" Update Calendar ",-1)])]),_:1},8,["loading"]),s(w,{type:"button",onClick:i},{default:o(()=>[...d[6]||(d[6]=[p("Cancel",-1)])]),_:1})])]),default:o(()=>[t("form",{onSubmit:ee(m,["prevent"])},[t("div",et,[s($,{label:"Name",required:"","input-id":"edit-calendar-name",error:c.name},{default:o(()=>[s(F,{id:"edit-calendar-name",modelValue:r.name,"onUpdate:modelValue":d[0]||(d[0]=u=>r.name=u),type:"text",required:""},null,8,["modelValue"])]),_:1},8,["error"]),s($,{label:"URL",required:"","input-id":"edit-calendar-url",error:c.url},{default:o(()=>[s(F,{id:"edit-calendar-url",modelValue:r.url,"onUpdate:modelValue":d[1]||(d[1]=u=>r.url=u),type:"url",required:""},null,8,["modelValue"])]),_:1},8,["error"]),s($,{label:"Color","input-id":"edit-calendar-color",error:c.color},{default:o(()=>[s(F,{id:"edit-calendar-color",modelValue:r.color,"onUpdate:modelValue":d[2]||(d[2]=u=>r.color=u),type:"color"},null,8,["modelValue"])]),_:1},8,["error"]),t("div",tt,[s(M,{id:"edit-hide-from-public","model-value":!r.visible_to_public,"onUpdate:modelValue":d[3]||(d[3]=u=>r.visible_to_public=!u),label:"Hide calendar from public view"},null,8,["model-value"]),s(M,{id:"edit-hide-details-from-public","model-value":!r.show_details_to_public,"onUpdate:modelValue":d[4]||(d[4]=u=>r.show_details_to_public=!u),label:"Hide event details for public view (show as time blocks only)"},null,8,["model-value"])])])],32)]),_:1},8,["high-z-index"]))}},lt={class:"text-gray-700 dark:text-gray-300"},st={class:"flex gap-2 justify-end"},ot={__name:"ModalDeleteCalendar",props:{calendar:{type:Object,required:!0},highZIndex:{type:Boolean,default:!1}},emits:["close","calendar-deleted"],setup(k,{emit:_}){const v=k,g=_,l=h(!1),n=N();async function r(){l.value=!0;try{const m=await S.calendar.delete(v.calendar.id);m.success?(n.success(m.message||"Calendar deleted successfully"),g("calendar-deleted"),g("close")):n.error(m.message||"Failed to delete calendar")}catch(m){n.error("Error deleting calendar: "+m.message)}finally{l.value=!1}}function c(){g("close")}return(m,i)=>(y(),P(D,{title:"Delete Confirmation","high-z-index":v.highZIndex,onClose:c},{footer:o(()=>[t("div",st,[s(w,{variant:"danger",onClick:r,loading:l.value},{default:o(()=>[...i[2]||(i[2]=[p(" Delete ",-1)])]),_:1},8,["loading"]),s(w,{onClick:c},{default:o(()=>[...i[3]||(i[3]=[p("Cancel",-1)])]),_:1})])]),default:o(()=>[t("p",lt,[i[0]||(i[0]=p(' Are you sure you want to delete "',-1)),t("strong",null,A(v.calendar.name),1),i[1]||(i[1]=p('"? This action cannot be undone. ',-1))])]),_:1},8,["high-z-index"]))}},dt={class:"max-h-64 overflow-y-auto border border-gray-200 dark:border-gray-700 rounded-lg"},nt={class:"flex items-center gap-2"},it={key:0,class:"px-4 py-8 text-center text-gray-500 dark:text-gray-400"},ut={class:"flex gap-2 justify-end"},ct={__name:"ModalFeedCalendars",props:{calendars:{type:Array,required:!0},selectedCalendars:{type:Array,default:()=>[]},highZIndex:{type:Boolean,default:!1}},emits:["close","calendars-updated"],setup(k,{emit:_}){const v=k,g=_,l=N(),n=h(!1),r=h([...v.selectedCalendars]);function c(d){return r.value.includes(d)}function m(d,u){if(u)r.value.includes(d)||r.value.push(d);else{const x=r.value.indexOf(d);x!==-1&&r.value.splice(x,1)}}async function i(){n.value=!0;try{const d=await S.settings.updateFeedCalendars(r.value);d.success?(l.success("Feed calendars updated"),g("calendars-updated",r.value),g("close")):l.error(d.message||"Failed to update feed calendars")}catch(d){l.error("Error updating feed calendars: "+d.message)}finally{n.value=!1}}function b(){g("close")}return(d,u)=>(y(),P(D,{title:"Select Feed Calendars","high-z-index":v.highZIndex,onClose:b},{footer:o(()=>[t("div",ut,[s(w,{variant:"primary",onClick:i,loading:n.value},{default:o(()=>[...u[0]||(u[0]=[p(" Save ",-1)])]),_:1},8,["loading"]),s(w,{onClick:b},{default:o(()=>[...u[1]||(u[1]=[p("Cancel",-1)])]),_:1})])]),default:o(()=>[u[2]||(u[2]=t("p",{class:"text-sm text-gray-600 dark:text-gray-400 mb-4"}," Select which calendars to include in your feed. Leave all unchecked to include all calendars. ",-1)),t("div",dt,[(y(!0),C(fe,null,ge(v.calendars,x=>(y(),C("div",{key:x.id,class:"flex items-center gap-3 px-4 py-3 hover:bg-gray-50 dark:hover:bg-gray-800 border-b border-gray-200 dark:border-gray-700 last:border-b-0"},[s(M,{id:`feed-cal-${x.id}`,"model-value":c(x.id),"onUpdate:modelValue":Z=>m(x.id,Z)},{default:o(()=>[t("span",nt,[t("span",{class:"w-3 h-3 rounded-full flex-shrink-0",style:pe({backgroundColor:x.color})},null,4),p(" "+A(x.name),1)])]),_:2},1032,["id","model-value","onUpdate:modelValue"])]))),128)),v.calendars.length===0?(y(),C("div",it," No calendars available ")):V("",!0)])]),_:1},8,["high-z-index"]))}},ft={class:"flex h-[500px]"},gt={class:"w-36 border-r border-gray-300 bg-gray-100 dark:border-gray-600 dark:bg-gray-900"},pt={class:"py-4 pl-4 pr-3 space-y-2"},mt={class:"flex-1 overflow-hidden"},yt={key:0,class:"h-full overflow-y-auto space-y-6 p-6"},vt={class:"flex justify-between items-center mb-4"},bt={class:"space-y-4"},xt={class:"h-[400px] overflow-y-auto border border-gray-200 rounded-lg bg-white dark:border-gray-600 dark:bg-gray-800"},wt={class:"overflow-x-hidden"},ht={class:"w-full table-fixed"},kt={class:"bg-white divide-y divide-gray-200 dark:bg-gray-800 dark:divide-gray-700"},Ct={class:"px-4 py-4"},_t={class:"flex items-start space-x-3"},Ut={class:"min-w-0 flex-1"},Vt={class:"font-medium text-gray-900 dark:text-gray-100"},Pt={class:"mt-2"},St={key:0,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800 dark:bg-red-900/50 dark:text-red-300 whitespace-nowrap"},$t={key:1,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300 whitespace-nowrap"},Et={key:2,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-300 whitespace-nowrap"},jt={class:"px-4 py-4 text-right"},Ft={class:"flex gap-2 justify-end"},Rt={key:0},Lt={key:1,class:"h-full overflow-y-auto space-y-6 p-6"},At={class:"space-y-6"},Tt={class:"space-y-4"},zt={class:"space-y-4 border-t border-gray-200 dark:border-gray-700 pt-4"},Mt={key:0,class:"space-y-4"},qt={class:"text-sm py-1.5 text-gray-600 dark:text-gray-400"},Ot={class:"border-t border-gray-200 dark:border-gray-700 pt-4"},Bt={class:"border-t border-gray-200 dark:border-gray-700 pt-4"},It={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Nt={class:"border-t border-gray-200 dark:border-gray-700 pt-4"},Dt={key:0,class:"space-y-4"},Zt={class:"p-4 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg text-center"},Ht={key:1,class:"space-y-4"},Jt={class:"flex items-center gap-2 p-2 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg"},Gt=["title"],Wt={class:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg"},Yt={class:"text-xs text-gray-500 dark:text-gray-400"},Kt={class:"p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg"},Qt={class:"flex items-center justify-between"},Xt={key:2,class:"h-full overflow-y-auto space-y-6 p-6"},ea={key:3,class:"h-full overflow-y-auto space-y-6 p-6"},ta={class:"space-y-6"},aa={class:"space-y-4"},ra={class:"text-sm text-gray-600 dark:text-gray-400"},ia={__name:"ModalSettings",props:{calendars:{type:Array,default:()=>[]},initialTab:{type:String,default:"calendars"},isAuthenticated:{type:Boolean,default:!1}},emits:["close","calendar-updated","show-password-modal","auth-changed"],setup(k,{emit:_}){const v=k,g=_,l=N(),n=Ne(),{theme:r,setTheme:c}=Ie(),m=Oe(v,"isAuthenticated"),i=z({enabled:!1,schedule:"0 */1 * * *",status:"",lastRun:""}),{loading:b,refresh:d}=le(()=>S.settings.getCronSettings(),{immediate:!1});async function u(){try{const a=await d();return a&&a.success?Object.assign(i,{...a.data,schedule:a.data.schedule||"0 */1 * * *"}):a&&l.error(a.message||"Failed to load auto refresh settings"),a}catch(a){return l.error("Error loading auto refresh settings: "+a.message),{success:!1,message:a.message,errors:null,data:null}}}const x=h(!1);async function Z(){if(!x.value){x.value=!0;try{const a=await S.settings.updateCronSettings(i.enabled,i.schedule);return a.success?(l.success(a.message||"Auto refresh settings updated"),Object.assign(i,a.data),a):(l.error(a.message||"Failed to update auto refresh settings"),a)}catch(a){return l.error("Error updating auto refresh settings: "+a.message),{success:!1,message:a.message,errors:null,data:null}}finally{x.value=!1}}}const j=h(m.value?v.initialTab:"about"),H=h(!1),J=h(!1),G=h(!1),q=h(null),O=h(null),te=de("importInput"),U=z({currentPassword:"",newPassword:"",confirmPassword:""}),Y=h(!1),R=z({currentPassword:"",newPassword:"",confirmPassword:""}),K=h(!1),{loading:me,refresh:ye}=le(()=>S.calendar.export(),{immediate:!1}),Q=h(!1),L=h(!1),B=h(!1),ve=I(()=>new Date().getFullYear());function be(a){q.value=a,J.value=!0}function xe(a){O.value=a,G.value=!0}function we(){g("calendar-updated"),H.value=!1}function he(){g("calendar-updated"),J.value=!1,q.value=null}function ke(){g("calendar-updated"),G.value=!1,O.value=null}async function Ce(){try{const a=await ye();if(a?.success){const e=new Blob([JSON.stringify(a.data,null,2)],{type:"application/json"}),f=URL.createObjectURL(e),E=document.createElement("a");E.href=f,E.download=`calendar-settings-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(E),E.click(),document.body.removeChild(E),URL.revokeObjectURL(f),l.success(a.message||"Settings exported successfully")}else a&&l.error(a.message||"Failed to export settings")}catch(a){l.error("Error exporting settings: "+a.message)}}function _e(){te.value.click()}async function Ue(a){const e=a.target.files[0];if(e){Q.value=!0;try{if(!e.name.endsWith(".json"))throw new Error("Please select a JSON file");if(e.size>1024*1024)throw new Error("File size too large. Please select a file under 1MB");const f=await e.text(),E=JSON.parse(f);if(!E.calendars||!Array.isArray(E.calendars))throw new Error("Invalid settings file format. Expected a 'calendars' array");const re=await S.calendar.import(E.calendars);if(re.success)g("calendar-updated"),l.success("Settings imported successfully");else throw new Error(re.message||"Failed to import calendars")}catch(f){f instanceof SyntaxError?l.error("Invalid JSON file format"):l.error("Error importing settings: "+f.message)}finally{Q.value=!1,a.target.value=""}}}const X=h(!1);async function Ve(){X.value=!0;try{await n.logout()&&(g("auth-changed"),g("close"))}catch(a){l.error("Logout error: "+a.message)}finally{X.value=!1}}async function Pe(){K.value=!0;try{const a=await S.calendar.refresh();if(a.success){const e=a.data;l.success(`Calendars refreshed: ${e.successful} successful, ${e.failed} failed`),g("calendar-updated"),await u()}else l.error(a.message||"Failed to refresh calendars")}catch(a){l.error("Error refreshing calendars: "+a.message)}finally{K.value=!1}}async function Se(){R.currentPassword="",R.newPassword="",R.confirmPassword="",Y.value=!0;try{const a=await S.auth.changePassword(U.currentPassword,U.newPassword,U.confirmPassword);a.success?(U.currentPassword="",U.newPassword="",U.confirmPassword="",await n.initialize(),l.success(a.message||"Password changed successfully")):(l.error(a.message||"Failed to change password"),a.errors&&Object.keys(a.errors).forEach(e=>{R.hasOwnProperty(e)&&(R[e]=a.errors[e])}))}finally{Y.value=!1}}async function $e(){if(!L.value){L.value=!0;try{const a=await S.settings.regenerateFeedToken();a.success?(n.setFeedToken({token:a.data.token,feedUrl:a.data.feedUrl,calendars:a.data.calendars||[]}),l.success("Feed URL generated successfully"),B.value=!0):l.error(a.message||"Failed to generate feed URL")}catch(a){l.error("Error generating feed URL: "+a.message)}finally{L.value=!1}}}async function Ee(){if(!L.value){L.value=!0;try{const a=await S.settings.regenerateFeedToken();a.success?(n.setFeedToken({token:a.data.token,feedUrl:a.data.feedUrl,calendars:a.data.calendars||[]}),l.success("Feed URL regenerated successfully")):l.error(a.message||"Failed to regenerate feed URL")}catch(a){l.error("Error regenerating feed URL: "+a.message)}finally{L.value=!1}}}function je(){const a=window.location.origin+n.feedToken.value?.feedUrl;navigator.clipboard.writeText(a),l.success("Feed URL copied to clipboard")}function Fe(a){n.setFeedCalendars(a),B.value=!1}const Re=I(()=>{const a=n.feedToken.value?.calendars||[];return a.length===0?"All calendars":`${a.length} calendar${a.length===1?"":"s"}`}),ae=I(()=>n.feedToken.value?.feedUrl?window.location.origin+n.feedToken.value.feedUrl:"");function W(a){!m.value&&a!=="about"||(j.value=a)}function Le(){g("show-password-modal")}return Be(()=>{m.value&&(n.cronSettings.value?Object.assign(i,{...n.cronSettings.value,schedule:n.cronSettings.value.schedule||"0 */1 * * *"}):u())}),ce(m,a=>{a&&(n.cronSettings.value?Object.assign(i,{...n.cronSettings.value,schedule:n.cronSettings.value.schedule||"0 */1 * * *"}):u())}),(a,e)=>(y(),P(D,{title:"Settings",size:"large","body-padding":!1,onClose:e[15]||(e[15]=f=>g("close"))},{default:o(()=>[t("div",ft,[t("div",gt,[t("nav",pt,[s(w,{onClick:e[0]||(e[0]=f=>W("calendars")),variant:j.value==="calendars"?"primary":"default",disabled:!m.value,class:"w-full justify-start !text-left !mr-0"},{default:o(()=>[...e[16]||(e[16]=[p(" Calendars ",-1)])]),_:1},8,["variant","disabled"]),s(w,{onClick:e[1]||(e[1]=f=>W("preferences")),variant:j.value==="preferences"?"primary":"default",disabled:!m.value,class:"w-full justify-start !text-left !mr-0"},{default:o(()=>[...e[17]||(e[17]=[p(" Preferences ",-1)])]),_:1},8,["variant","disabled"]),s(w,{onClick:e[2]||(e[2]=f=>W("account")),variant:j.value==="account"?"primary":"default",disabled:!m.value,class:"w-full justify-start !text-left !mr-0"},{default:o(()=>[...e[18]||(e[18]=[p(" Account ",-1)])]),_:1},8,["variant","disabled"]),s(w,{onClick:e[3]||(e[3]=f=>W("about")),variant:j.value==="about"?"primary":"default",class:"w-full justify-start !text-left !mr-0"},{default:o(()=>[...e[19]||(e[19]=[p(" About ",-1)])]),_:1},8,["variant"]),m.value?(y(),P(w,{key:0,onClick:Ve,variant:"danger",loading:X.value,class:"w-full justify-start !text-left !mr-0"},{default:o(()=>[...e[20]||(e[20]=[p(" Logout ",-1)])]),_:1},8,["loading"])):(y(),P(w,{key:1,onClick:Le,variant:"default",class:"w-full justify-start !text-left !mr-0"},{default:o(()=>[...e[21]||(e[21]=[p(" Login ",-1)])]),_:1}))])]),t("div",mt,[j.value==="calendars"?(y(),C("div",yt,[t("div",vt,[e[23]||(e[23]=t("h3",{class:"text-lg font-medium text-gray-900 dark:text-gray-100"}," Calendars ",-1)),s(w,{variant:"primary",onClick:e[4]||(e[4]=f=>H.value=!0)},{default:o(()=>[...e[22]||(e[22]=[p(" Add Calendar ",-1)])]),_:1})]),t("div",bt,[t("div",xt,[t("div",wt,[t("table",ht,[e[27]||(e[27]=t("thead",{class:"bg-gray-50 sticky top-0 z-10 dark:bg-gray-900"},[t("tr",null,[t("th",{class:"w-3/4 px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Calendar "),t("th",{class:"w-1/4 px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Actions ")])],-1)),t("tbody",kt,[(y(!0),C(fe,null,ge(k.calendars,f=>(y(),C("tr",{key:f.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[t("td",Ct,[t("div",_t,[t("div",{class:"w-4 h-4 rounded-full flex-shrink-0 mt-0.5",style:pe({backgroundColor:f.color})},null,4),t("div",Ut,[t("div",Vt,A(f.name),1),t("div",Pt,[f.visible_to_public?f.show_details_to_public?(y(),C("span",Et," Visible to Public ")):(y(),C("span",$t," Details Hidden from Public ")):(y(),C("span",St," Hidden from Public "))])])])]),t("td",jt,[t("div",Ft,[s(w,{onClick:E=>be(f),variant:"primary",size:"small"},{default:o(()=>[...e[24]||(e[24]=[p(" Edit ",-1)])]),_:1},8,["onClick"]),s(w,{onClick:E=>xe(f),variant:"danger",size:"small"},{default:o(()=>[...e[25]||(e[25]=[p(" Delete ",-1)])]),_:1},8,["onClick"])])])]))),128)),k.calendars.length===0?(y(),C("tr",Rt,[...e[26]||(e[26]=[t("td",{colspan:"2",class:"px-4 py-8 text-center text-gray-500 dark:text-gray-400"},' No calendars configured. Click "Add Calendar" to get started. ',-1)])])):V("",!0)])])])])])])):V("",!0),j.value==="preferences"?(y(),C("div",Lt,[e[47]||(e[47]=t("div",{class:"flex justify-between items-center mb-4"},[t("h3",{class:"text-lg font-medium text-gray-900 dark:text-gray-100"}," Preferences ")],-1)),t("div",At,[t("div",Tt,[e[29]||(e[29]=t("h4",{class:"text-md font-medium text-gray-900 dark:text-gray-100"}," Appearance ",-1)),s($,{label:"Theme","input-id":"theme-select"},{default:o(()=>[s(se,{id:"theme-select","model-value":T(r),"onUpdate:modelValue":T(c)},{default:o(()=>[...e[28]||(e[28]=[t("option",{value:"system"},"System",-1),t("option",{value:"light"},"Light",-1),t("option",{value:"dark"},"Dark",-1)])]),_:1},8,["model-value","onUpdate:modelValue"])]),_:1})]),t("div",zt,[e[31]||(e[31]=t("h4",{class:"text-md font-medium text-gray-900 dark:text-gray-100"}," Auto Refresh ",-1)),t("div",null,[s(M,{id:"enable-auto-refresh",modelValue:i.enabled,"onUpdate:modelValue":[e[5]||(e[5]=f=>i.enabled=f),Z],label:"Enable automatic calendar refresh",disabled:T(b)||x.value},null,8,["modelValue","disabled"])]),i.enabled?(y(),C("div",Mt,[s($,{label:"Refresh Schedule","input-id":"refresh-schedule"},{default:o(()=>[s(se,{id:"refresh-schedule",modelValue:i.schedule,"onUpdate:modelValue":[e[6]||(e[6]=f=>i.schedule=f),Z],disabled:T(b)||x.value},{default:o(()=>[...e[30]||(e[30]=[t("option",{value:"0 */1 * * *"},"Every hour",-1),t("option",{value:"0 */2 * * *"},"Every 2 hours",-1),t("option",{value:"0 */4 * * *"},"Every 4 hours",-1),t("option",{value:"0 */6 * * *"},"Every 6 hours",-1),t("option",{value:"0 */12 * * *"},"Every 12 hours",-1),t("option",{value:"0 0 * * *"},"Daily",-1)])]),_:1},8,["modelValue","disabled"])]),_:1}),i.lastRun?(y(),P($,{key:0,label:"Last Run"},{default:o(()=>[t("div",qt,A(new Date(i.lastRun).toLocaleString()),1)]),_:1})):V("",!0)])):V("",!0)]),t("div",Ot,[e[33]||(e[33]=t("h4",{class:"text-md font-medium text-gray-900 dark:text-gray-100 mb-4"}," Manual Refresh ",-1)),s(w,{onClick:Pe,loading:K.value,variant:"primary"},{default:o(()=>[...e[32]||(e[32]=[p(" Refresh All Calendars Now ",-1)])]),_:1},8,["loading"])]),t("div",Bt,[e[36]||(e[36]=t("h4",{class:"text-md font-medium text-gray-900 dark:text-gray-100 mb-4"}," Import/Export ",-1)),t("div",It,[s(w,{onClick:Ce,variant:"primary",loading:T(me),class:"w-full"},{default:o(()=>[...e[34]||(e[34]=[p(" Export Settings ",-1)])]),_:1},8,["loading"]),s(w,{onClick:_e,variant:"default",loading:Q.value,class:"w-full"},{default:o(()=>[...e[35]||(e[35]=[p(" Import Settings ",-1)])]),_:1},8,["loading"]),t("input",{ref_key:"importInput",ref:te,type:"file",accept:".json",onChange:Ue,class:"hidden"},null,544)])]),t("div",Nt,[e[45]||(e[45]=t("h4",{class:"text-md font-medium text-gray-900 dark:text-gray-100 mb-2"}," Calendar Feed ",-1)),e[46]||(e[46]=t("p",{class:"text-sm text-gray-600 dark:text-gray-400 mb-4"}," Subscribe to a URL in any calendar app to see your selected calendars combined. ",-1)),T(n).feedToken.value?(y(),C("div",Ht,[t("div",null,[e[40]||(e[40]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Feed URL ",-1)),t("div",Jt,[t("code",{class:"flex-1 text-xs font-mono text-gray-700 dark:text-gray-300 truncate select-all",title:ae.value},A(ae.value),9,Gt),s(w,{onClick:je,variant:"primary",size:"small",class:"flex-shrink-0"},{default:o(()=>[...e[39]||(e[39]=[p(" Copy ",-1)])]),_:1})])]),t("div",Wt,[t("div",null,[e[41]||(e[41]=t("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"}," Included Calendars ",-1)),t("p",Yt,A(Re.value),1)]),s(w,{onClick:e[7]||(e[7]=f=>B.value=!0),variant:"default",size:"small"},{default:o(()=>[...e[42]||(e[42]=[p(" Select ",-1)])]),_:1})]),t("div",Kt,[t("div",Qt,[e[44]||(e[44]=t("div",null,[t("span",{class:"text-sm font-medium text-red-700 dark:text-red-400"}," Regenerate URL "),t("p",{class:"text-xs text-red-600 dark:text-red-400"}," This will invalidate the current URL ")],-1)),s(w,{onClick:Ee,loading:L.value,variant:"danger",size:"small"},{default:o(()=>[...e[43]||(e[43]=[p(" Regenerate ",-1)])]),_:1},8,["loading"])])])])):(y(),C("div",Dt,[t("div",Zt,[e[38]||(e[38]=t("p",{class:"text-sm text-gray-600 dark:text-gray-400 mb-3"}," No feed URL has been generated yet. ",-1)),s(w,{onClick:$e,loading:L.value,variant:"primary"},{default:o(()=>[...e[37]||(e[37]=[p(" Generate Feed URL ",-1)])]),_:1},8,["loading"])])]))])])])):V("",!0),j.value==="account"?(y(),C("div",Xt,[t("div",null,[e[50]||(e[50]=t("h3",{class:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-4"}," Account ",-1)),t("form",{onSubmit:ee(Se,["prevent"]),class:"space-y-4"},[e[49]||(e[49]=t("input",{type:"text",name:"username",autocomplete:"username",value:"admin",readonly:"","aria-hidden":"true",tabindex:"-1",style:{position:"absolute",left:"-9999px",width:"1px",height:"1px"}},null,-1)),s($,{label:"Current Password",required:"","input-id":"currentPassword",error:R.currentPassword},{default:o(()=>[s(F,{id:"currentPassword",modelValue:U.currentPassword,"onUpdate:modelValue":e[8]||(e[8]=f=>U.currentPassword=f),type:"password",placeholder:"Enter current password",required:"",autocomplete:"current-password"},null,8,["modelValue"])]),_:1},8,["error"]),s($,{label:"New Password",required:"","input-id":"newPassword",error:R.newPassword},{default:o(()=>[s(F,{id:"newPassword",modelValue:U.newPassword,"onUpdate:modelValue":e[9]||(e[9]=f=>U.newPassword=f),type:"password",placeholder:"Enter new password (min 8 characters)",required:"",autocomplete:"new-password"},null,8,["modelValue"])]),_:1},8,["error"]),s($,{label:"Confirm New Password",required:"","input-id":"confirmNewPassword",error:R.confirmPassword},{default:o(()=>[s(F,{id:"confirmNewPassword",modelValue:U.confirmPassword,"onUpdate:modelValue":e[10]||(e[10]=f=>U.confirmPassword=f),type:"password",placeholder:"Confirm new password",required:"",autocomplete:"new-password"},null,8,["modelValue"])]),_:1},8,["error"]),s(w,{type:"submit",loading:Y.value,disabled:!U.currentPassword||!U.newPassword||!U.confirmPassword,variant:"primary"},{default:o(()=>[...e[48]||(e[48]=[p(" Change Password ",-1)])]),_:1},8,["loading","disabled"])],32)])])):V("",!0),j.value==="about"?(y(),C("div",ea,[e[54]||(e[54]=t("div",{class:"flex justify-between items-center mb-4"},[t("h3",{class:"text-lg font-medium text-gray-900 dark:text-gray-100"},"About")],-1)),t("div",ta,[t("div",aa,[e[52]||(e[52]=t("p",{class:"text-sm text-gray-600 dark:text-gray-400 leading-relaxed"}," A web-based calendar application with multiple calendar source support via iCal/WebCal URLs ",-1)),e[53]||(e[53]=t("p",{class:"text-sm text-gray-600 dark:text-gray-400"},[p(" Questions or feedback? "),t("a",{href:"mailto:github@jaw.dev",class:"text-gray-800 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100 underline"}," Drop me a line "),p(" or "),t("a",{href:"https://github.com/wajeht/calendar/issues",target:"_blank",rel:"noopener noreferrer",class:"text-gray-800 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100 underline"}," create an issue "),p(" on "),t("a",{href:"https://github.com/wajeht/calendar",target:"_blank",rel:"noopener noreferrer",class:"text-gray-800 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100 underline"}," Github ")],-1)),t("p",ra,[p(" Copyright © "+A(ve.value)+". Made with ❤️ by ",1),e[51]||(e[51]=t("a",{href:"https://github.com/wajeht",target:"_blank",rel:"noopener noreferrer",class:"text-gray-800 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100 underline"}," @wajeht ",-1))])])])])):V("",!0)])]),H.value?(y(),P(Xe,{key:0,"high-z-index":"",onClose:e[11]||(e[11]=f=>H.value=!1),onCalendarAdded:we})):V("",!0),J.value&&q.value?(y(),P(rt,{key:1,calendar:q.value,"high-z-index":"",onClose:e[12]||(e[12]=f=>{J.value=!1,q.value=null}),onCalendarUpdated:he},null,8,["calendar"])):V("",!0),G.value&&O.value?(y(),P(ot,{key:2,calendar:O.value,"high-z-index":"",onClose:e[13]||(e[13]=f=>{G.value=!1,O.value=null}),onCalendarDeleted:ke},null,8,["calendar"])):V("",!0),B.value?(y(),P(ct,{key:3,calendars:k.calendars,"selected-calendars":T(n).feedToken.value?.calendars||[],"high-z-index":"",onClose:e[14]||(e[14]=f=>B.value=!1),onCalendarsUpdated:Fe},null,8,["calendars","selected-calendars"])):V("",!0)]),_:1}))}};export{ia as default};
