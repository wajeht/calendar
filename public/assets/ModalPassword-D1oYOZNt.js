import{p as g,q as x,y as m,c as b,o as _,w as r,a as f,z as h,b as u,k,A as V,r as c,B as w}from"./vendor-DfjTe3v5.js";import{_ as v,M as C}from"./Button-CC4DDPTB.js";import{_ as M,a as T}from"./Input-BxoBBgjz.js";import{a as $,u as q}from"./index-B2sipo_L.js";import"./fullcalendar-DAzJmkx6.js";const z={__name:"ModalPassword",emits:["close","authenticated"],setup(B,{emit:y}){const i=y,l=q(),s=c(!1),t=c(""),o=g("passwordInput"),n=k({password:""});async function d(){if(!s.value){n.password="",s.value=!0;try{const a=await $.auth.login(t.value);if(a.success)l.success(a.message||"Logged in successfully"),setTimeout(()=>{i("authenticated")},100);else{l.error(a.message||"Invalid password"),a.errors&&Object.keys(a.errors).forEach(e=>{n.hasOwnProperty(e)&&(n[e]=a.errors[e])}),s.value=!1,t.value="",await m(),o.value?.focus();return}}catch(a){l.error("Authentication error: "+a.message),s.value=!1,t.value="",await m(),o.value?.focus();return}s.value=!1}}return x(async()=>{await m(),o.value?.focus()}),(a,e)=>(_(),b(C,{title:"Authentication Required","high-z-index":"",onClose:e[2]||(e[2]=p=>i("close"))},{footer:r(()=>[u(v,{variant:"primary",onClick:d,loading:s.value},{default:r(()=>[...e[4]||(e[4]=[w(" Login ",-1)])]),_:1},8,["loading"]),u(v,{onClick:e[1]||(e[1]=p=>i("close")),disabled:s.value},{default:r(()=>[...e[5]||(e[5]=[w("Cancel",-1)])]),_:1},8,["disabled"])]),default:r(()=>[f("form",{onSubmit:h(d,["prevent"])},[e[3]||(e[3]=f("input",{type:"text",name:"username",autocomplete:"username",value:"admin",readonly:"","aria-hidden":"true",tabindex:"-1",style:{position:"absolute",left:"-9999px",width:"1px",height:"1px"}},null,-1)),u(M,{label:"Password",required:"","input-id":"password",error:n.password},{default:r(()=>[u(T,{id:"password",modelValue:t.value,"onUpdate:modelValue":e[0]||(e[0]=p=>t.value=p),type:"password",placeholder:"Enter password",required:"",ref_key:"passwordInput",ref:o,disabled:s.value,autocomplete:"current-password",onKeyup:V(d,["enter"])},null,8,["modelValue","disabled"])]),_:1},8,["error"])],32)]),_:1}))}};export{z as default};
