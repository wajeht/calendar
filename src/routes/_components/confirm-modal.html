<div class="modal-overlay modal-overlay-high" id="confirmModalOverlay"></div>
<div class="modal modal-high" id="confirmModal" style="max-width: 450px;">
    <div class="modal-header">
        <h2 id="confirmModalTitle">Confirm Action</h2>
    </div>
    <div class="modal-body">
        <div id="confirmModalMessage" style="color: #666; font-size: 14px; line-height: 1.5; margin-bottom: 20px;">
            Are you sure you want to proceed?
        </div>
    </div>
    <div class="modal-footer">
        <button onclick="confirmModal.resolve(true)" class="fc-button fc-button-primary" id="confirmModalConfirm">
            Confirm
        </button>
        <button onclick="confirmModal.resolve(false)" class="fc-button" id="confirmModalCancel">
            Cancel
        </button>
    </div>
</div>

<script>
class ConfirmModal {
    constructor() {
        this.modal = document.getElementById('confirmModal');
        this.overlay = document.getElementById('confirmModalOverlay');
        this.title = document.getElementById('confirmModalTitle');
        this.message = document.getElementById('confirmModalMessage');
        this.confirmBtn = document.getElementById('confirmModalConfirm');
        this.cancelBtn = document.getElementById('confirmModalCancel');

        this.currentResolve = null;
        this.isOpen = false;

        // Close on overlay click
        this.overlay.addEventListener('click', () => {
            this.resolve(false);
        });

        // Close on escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && this.isOpen) {
                this.resolve(false);
            }
        });
    }

    show(options = {}) {
        return new Promise((resolve) => {
            const {
                title = 'Confirm Action',
                message = 'Are you sure you want to proceed?',
                confirmText = 'Confirm',
                cancelText = 'Cancel',
                confirmClass = 'fc-button-primary',
                danger = false
            } = options;

            this.currentResolve = resolve;
            this.isOpen = true;

            // Set content
            this.title.textContent = title;
            this.message.innerHTML = message;
            this.confirmBtn.textContent = confirmText;
            this.cancelBtn.textContent = cancelText;

            // Set button styles
            this.confirmBtn.className = `fc-button ${danger ? 'fc-button-danger' : confirmClass}`;

            // Show modal
            this.modal.classList.add('show');
            this.overlay.classList.add('show');

            // Focus confirm button
            this.confirmBtn.focus();
        });
    }

    resolve(result) {
        if (!this.isOpen || !this.currentResolve) return;

        this.isOpen = false;
        this.modal.classList.remove('show');
        this.overlay.classList.remove('show');

        const resolve = this.currentResolve;
        this.currentResolve = null;

        resolve(result);
    }

    // Convenience methods
    confirm(message, title = 'Confirm Action') {
        return this.show({
            title,
            message,
            confirmText: 'Confirm',
            cancelText: 'Cancel'
        });
    }

    delete(itemName = 'this item') {
        return this.show({
            title: 'Delete Confirmation',
            message: `Are you sure you want to delete ${itemName}? This action cannot be undone.`,
            confirmText: 'Delete',
            cancelText: 'Cancel',
            danger: true
        });
    }

    warning(message, title = 'Warning') {
        return this.show({
            title,
            message,
            confirmText: 'Continue',
            cancelText: 'Cancel',
            confirmClass: 'fc-button-warning'
        });
    }
}

const confirmModal = new ConfirmModal();
</script>
