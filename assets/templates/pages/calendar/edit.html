{{define "main"}}

<form action="/calendars/{{.Calendar.ID}}" method="POST">
    <fieldset>
        <legend>Edit Calendar</legend>

        <p>
            <label for="name">Calendar Name (optional)</label>
            <input type="text" id="name" name="name" value="{{.Calendar.Name}}" placeholder="My Calendar">
        </p>

        <p>
            <label for="url">Calendar URL</label>
            <input type="url" id="url" name="url" value="{{.Calendar.URL}}"
                placeholder="webcal://example.com/calendar.ics" required>
            <small>Supports Google Calendar, Apple Calendar, Outlook, and other iCal URLs</small>
        </p>

        <p>
            <label for="color">Calendar Color</label>
            <input type="color" id="color" name="color" value="{{.Calendar.Color}}">
        </p>

        <p>
            <label>
                <input type="checkbox" name="hidden" value="1" {{if .Calendar.Hidden}}checked{{end}}>
                Hide calendar from public view
            </label>
        </p>

        <p>
            <label>
                <input type="checkbox" name="hide_details" value="1" {{if .Calendar.Details}}checked{{end}}>
                Hide event details for public view (show as time blocks only)
            </label>
        </p>
    </fieldset>

    <p>
        <button type="submit">Update Calendar</button>
        <a href="/calendars">Cancel</a>
        <button type="button" onclick="deleteCalendar({{.Calendar.ID}})">Delete Calendar</button>
    </p>
</form>

<script>
    function deleteCalendar(id) {
        if (confirm('Are you sure you want to delete this calendar?')) {
            fetch(`/calendars/${id}`, {
                method: 'DELETE',
                credentials: 'include'
            }).then(response => {
                if (response.ok) {
                    window.location.href = '/settings';
                } else {
                    alert('Failed to delete calendar');
                }
            });
        }
    }
</script>
{{end}}
