{{define "main"}}

{{if .Calendars}}
<table>
    <thead>
        <tr>
            <th>Name</th>
            <th>URL</th>
            <th>Status</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {{range .Calendars}}
        <tr>
            <td>
                <span
                    style="display: inline-block; width: 12px; height: 12px; background-color: {{.Color}}; border-radius: 3px; margin-right: 8px; vertical-align: middle;"></span>
                {{if .Name}}{{.Name}}{{else}}<em>Unnamed</em>{{end}}
            </td>
            <td>
                <a href="{{.URL}}" target="_blank" rel="noopener noreferrer">{{.URL}}</a>
            </td>
            <td>
                {{if .Hidden}}Hidden{{else}}Visible{{end}}
                {{if .Details}} â€¢ Private{{end}}
            </td>
            <td>
                <a href="/calendars/{{.ID}}/edit">Edit</a>
                <button type="button" onclick="deleteCalendar({{.ID}})">Delete</button>
            </td>
        </tr>
        {{end}}
    </tbody>
</table>
<p><a href="/calendars/create">Add Calendar</a></p>
{{else}}

<p>No calendars found. <a href="/calendars/create">Add your first calendar</a></p>

{{end}}

<script>
    function deleteCalendar(id) {
        if (confirm('Are you sure you want to delete this calendar?')) {
            fetch(`/calendars/${id}`, {
                method: 'DELETE'
            })
                .then(response => {
                    if (response.ok) {
                        location.reload();
                    } else {
                        alert('Error deleting calendar');
                    }
                })
                .catch(error => {
                    alert('Error deleting calendar');
                });
        }
    }
</script>

{{end}}
